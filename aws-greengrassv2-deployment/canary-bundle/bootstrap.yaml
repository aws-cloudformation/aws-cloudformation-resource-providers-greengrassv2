Resources:
  DeploymentCFNCanaryThing:
    Type: AWS::IoT::Thing
    Properties:
      ThingName: DeploymentCFNCanaryThing
  DeploymentSetupLambdaInvoke:
    DependsOn: DeploymentCFNCanaryThing
    DeletionPolicy: Retain
    UpdateReplacePolicy: Delete
    Metadata:
      Comment: "Adding DeletionPolicy and UpdateReplacePolicy for Cloudformation Deployment Safety"
    Type: AWS::CloudFormation::CustomResource
    Version: "1.0"
    Properties:
      ServiceToken:
        Fn::ImportValue: ComponentCleanupLambdaArn
      ResourceProperties:
        Region: !Ref "AWS::Region"
        ComponentVersionArn: !Sub "arn:${AWS::Partition}:greengrass:${AWS::Region}:${AWS::AccountId}:components:component2:versions:1.0.24"
  DeploymentCFNCanaryComponentVersion:
    DependsOn: DeploymentSetupLambdaInvoke
    Type: AWS::GreengrassV2::ComponentVersion
    Properties:
      InlineRecipe: "{\n    \"RecipeFormatVersion\": \"2020-01-25\",\n    \"ComponentName\": \"component2\",\n    \"ComponentVersion\": \"1.0.24\",\n    \"ComponentType\": \"aws.greengrass.generic\",\n    \"ComponentDescription\": \"This\",\n    \"ComponentPublisher\": \"You\",\n    \"Manifests\": [\n        {\n            \"Platform\": {\n                \"os\": \"darwin\"\n            },\n            \"Lifecycle\": {},\n            \"Artifacts\": []\n        },\n        {\n            \"Lifecycle\": {},\n            \"Artifacts\": []\n        }\n    ],\n    \"Lifecycle\": {\n        \"install\": {\n            \"script\": \"yuminstallpython\"\n        }\n    }\n}"